    
<script>
    function initMap() {
      map = new google.maps.Map(document.getElementById('map'), {
        zoom: 9,
        center: {lat: 42.05, lng: -70.25},
        mapTypeId: google.maps.MapTypeId.SATELLITE,
        scrollwheel:  false,
        scaleControl: false,
      });





            for (var i = 0; i < response.length ; i++) {
              polygons.push(new google.maps.Polygon({
              paths: response[i].cfile,
              strokeColor: '#F7F8FF',
              strokeOpacity: 0.8,
              strokeWeight: 0.35,
              fillColor: response[i].color,
              fillOpacity: 0.45,
              editable: false,


infoWindow.open(map);
              }); 
              google.maps.event.addListener(p, 'mouseover',function (event){
                $("#locdetails").css("display", "block");
                $( "#locdetails" ).append( "<p>"+ this.loc.short_name +"</p>" +"<p>" + this.mavg +  "</p>"+"<p>" + this.rep.length +  "</p>" );
                map.data.revertStyle();
        this.setOptions({
          strokeColor: '#F7F8FF',
          strokeWeight: 3 ,
          fillOpacity: 0.75
            });
              });
              google.maps.event.addListener(p, 'mouseout',function (event){
                $("#locdetails").css("display", "none");
                $( "#locdetails" ).empty();
              map.data.revertStyle();
          this.setOptions({
              strokeColor: '#F7F8FF',
            strokeOpacity: 0.8,
            strokeWeight: .35,
            fillOpacity: 0.5,
          });


</script> 



CONTROLLER


 before_action :set_current_user_reports



def index
  puts "YOLO".on_blue
   
      @reports = current_user.reports
      @reports_for_filter = @reports.select("DISTINCT(target_species)")

end




  @reports = current_user.reports

  @reports_for_filter = @reports.select("DISTINCT(target_species)") #sets up target_species for filter box


def filter
  @target_species = params[:target_species] unless params[:target_species].blank?
  @location = Location.find(params[:location]) unless params[:location].blank?
  @tide = params[:tide] unless params[:tide].blank?
  @month = params[:date].to_date.month unless params[:date].blank?

  puts "@month is #{@month}".green

  puts "@target_species is #{@target_species}\n"
  puts "@location is #{@location.inspect}\n"
  puts "@tide is #{@tide}\n"
  puts "@date is #{@date}\n"



  @reports = @reports.selected_species(@target_species) if @target_species
  @reports = @reports.selected_location(@location) if @location
  @reports = @reports.selected_tide(@tide) if @tide
  puts "@reports before date filter is #{@reports.inspect}\n".blue
  @reports = @reports.selected_date(@month) if @month








Private
  def set_current_user_reports
    @reports = current_user.reports
    @reports_for_filter = @reports.select("DISTINCT(target_species)") #sets up target_species for filter box
  end




REPORTS VIEW FILTER OLD



  <!-- start of Filters -->
<div class="row">
  <div class="col-lg-3">
    <br><br><br>
    <div class="col-sm-1"></div>
    <div class="col-sm-1"></div>
     <%= link_to 'Log New Catch Report', new_report_path, class: "btn btn-inverse btn-lg" %>  
     <div class="col-sm-1"></div>
  </div>
  <div class="col-sm-6">
    <form action="/filter" id="filter_form">
      <div class="container-fluid">
        <div class="panel-heading">
          <h4 class="M0">
            Report Filter 
          </h4>
          <div class="panel b bg-inverse">
            <div class= "plan">
              <table class= "table">
                  <thead> 
                    <tr>
                    <th><label for="target_species">Species</label></th>
                    <th><label for="location">Location</label></th>
                    <th><label for="tide">Tide</label></th>
                    <th><label for="date">Month</label></th>
                    </tr>
                  </thead> 
                  <tbody>
                    <tr> 
                      <td>
                        <select id="target_species" name="target_species">
                          <option value=""></option>
                          <!-- should be @reports_for_filter.each do -->
                            <% @reports_for_filter.each do |report| %>
                              <% puts "target species is #{report.target_species}".green %>
                              <option value="<%= report.target_species %>"><%= report.target_species %>
                              </option>
                            <% end %>
                          </select>
                      </td>     
                      <td> 
                        <select id="location" name="location">
                          <option value="Massachusetts">Massachusetts Locations</option>
                            <% @reports_for_filter_location.each do |location| %>
                          <option value="<%= location.id %>" <%= selected_locations(location) %>><%= location.short_name %></option>
                            <% end %>
                        </select> 
                      </td> 
                      <td> 
                        <select id="tide" name="tide">
                         <option value=""></option>
                            <% @reports_for_filter_tide.each do |report| %>
                          <option value="<%= report.tide %>" <%= selected_tide(report.tide) %>><%= report.tide %></option>
                          <% end %>
                        </select>
                      </td> 
                      <td> 
                        <select id="date" name="date">
                          <option value=""></option>
                          <option value="January">January</option>
                          <option value="February">February</option>
                          <option value="March">March</option>  
                          <option value="April">April</option>
                          <option value="May">May</option>
                          <option value="June">June</option>
                          <option value="July">July</option>
                          <option value="August">August</option> 
                          <option value="September">September</option>
                          <option value="October">October</option> 
                          <option value="November">November</option> 
                          <option value="December">December</option>
                        </select>
                      </td>  
                    </tr>
                  </tbody>
              </table>
                  <!-- button -->  
            </div>
          </div>
        </div> 
      </div>
    </form>
  </div>
  <div class="col-sm-3">
    <br><br><br>
    <div class="col-sm-1"></div>
    <div class="col-sm-1">
    <%= link_to 'Clear Filter', reports_path, class: 'btn btn-info btn-lg' %>
    </div>
    <div class="col-sm-1"></div>
  </div>
</div>

<!-- end of filters -->









